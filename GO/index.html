



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Scone Documentation - Secure Containers">
      
      
        <link rel="canonical" href="https://sconedocs.github.io/GO/">
      
      
        <meta name="author" content="Christof Fetzer">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>GO - SCONE</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#go" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://sconedocs.github.io" title="SCONE" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                SCONE
              </span>
              <span class="md-header-nav__topic">
                GO
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    SCONE
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../outline/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appsecurity/" title="Application-oriented security" class="md-nav__link">
      Application-oriented security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../background/" title="SCONE Background" class="md-nav__link">
      SCONE Background
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_CLI/" title="SCONE CLI" class="md-nav__link">
      SCONE CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_HOST_SETUP/" title="SCONE Host Setup" class="md-nav__link">
      SCONE Host Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_toolchain/" title="SCONE SGX toolchain" class="md-nav__link">
      SCONE SGX toolchain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Curated_Images/" title="SCONE Curated Images" class="md-nav__link">
      SCONE Curated Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_TUTORIAL/" title="SCONE Tutorial" class="md-nav__link">
      SCONE Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_GENERATE_IMAGE/" title="SCONE Create Image" class="md-nav__link">
      SCONE Create Image
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Dockerfile/" title="SCONE Dockerfile" class="md-nav__link">
      SCONE Dockerfile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Swarm_Example/" title="SCONE Swarm Example" class="md-nav__link">
      SCONE Swarm Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Compose/" title="SCONE Compose" class="md-nav__link">
      SCONE Compose
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_CAS/" title="SCONE CAS" class="md-nav__link">
      SCONE CAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_EE2EE/" title="Example E2E encryption" class="md-nav__link">
      Example E2E encryption
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Language Support
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Language Support
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../C/" title="C" class="md-nav__link">
      C
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../C++/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fortran/" title="Fortran" class="md-nav__link">
      Fortran
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="GO" class="md-nav__link md-nav__link--active">
      GO
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nodejs/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Rust/" title="Rust" class="md-nav__link">
      Rust
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Manuals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Manuals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_HOST/" title="scone host" class="md-nav__link">
      scone host
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_SERVICE/" title="scone service" class="md-nav__link">
      scone service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_STACK/" title="scone stack" class="md-nav__link">
      scone stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_SWARM/" title="scone swarm" class="md-nav__link">
      scone swarm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_VOLUME/" title="scone volume" class="md-nav__link">
      scone volume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Fileshield/" title="scone fspf" class="md-nav__link">
      scone fspf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Appendix
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Appendix
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_ENV/" title="Environment variables" class="md-nav__link">
      Environment variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MrEnclave/" title="MrEnclave" class="md-nav__link">
      MrEnclave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ssh/" title="ssh setup" class="md-nav__link">
      ssh setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Publications/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aboutScone/" title="About Scone" class="md-nav__link">
      About Scone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../news/" title="News" class="md-nav__link">
      News
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="go">GO<a class="headerlink" href="#go" title="Permanent link">&para;</a></h1>
<p>SCONE supports cross-compiling GO programs to run these inside of SGX enclaves. The GO cross-compiler is part of image <strong>sconecuratedimages/crosscompilers:scone</strong>.</p>
<h1 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h1>
<p>Start the SCONE crosscompiler container:</p>
<div class="codehilite"><pre><span></span>&gt; docker run -it -p <span class="m">8080</span>:8080 sconecuratedimages/crosscompilers:scone
$
</pre></div>

<p>Lets consider a simple GO program (take from a <a href="https://golang.org/doc/articles/wiki/">GO tutorial</a>):</p>
<div class="codehilite"><pre><span></span>$ cat &gt; web-srv.go <span class="s">&lt;&lt; EOF</span>
<span class="s">package main</span>

<span class="s">import (</span>
<span class="s">    &quot;os&quot;</span>
<span class="s">    &quot;fmt&quot;</span>
<span class="s">    &quot;net/http&quot;</span>
<span class="s">)</span>

<span class="s">func handler(w http.ResponseWriter, r *http.Request) {</span>
<span class="s">    fmt.Fprintf(w, &quot;Hi there, I love %s!\n&quot;, r.URL.Path[1:])</span>
<span class="s">    if r.URL.Path[1:] == &quot;EXIT&quot; {</span>
<span class="s">        os.Exit(0)</span>
<span class="s">    }</span>
<span class="s">}</span>

<span class="s">func main() {</span>
<span class="s">    http.HandleFunc(&quot;/&quot;, handler)</span>
<span class="s">    http.ListenAndServe(&quot;:8080&quot;, nil)</span>
<span class="s">}</span>
<span class="s">EOF</span>
</pre></div>

<p>You can cross-compile this program as follows:</p>
<div class="codehilite"><pre><span></span>$ <span class="nv">SCONE_HEAP</span><span class="o">=</span>1G scone-gccgo web-srv.go -O3 -o web-srv-go -g
</pre></div>

<p>You can start the compiled program (and enable some debug messages) as follows:</p>
<div class="codehilite"><pre><span></span>$ <span class="nv">SCONE_VERSION</span><span class="o">=</span><span class="m">1</span> ./web-srv-go <span class="p">&amp;</span>
<span class="nb">export</span> <span class="nv">SCONE_QUEUES</span><span class="o">=</span><span class="m">4</span>
<span class="nb">export</span> <span class="nv">SCONE_SLOTS</span><span class="o">=</span><span class="m">256</span>
<span class="nb">export</span> <span class="nv">SCONE_SIGPIPE</span><span class="o">=</span><span class="m">0</span>
<span class="nb">export</span> <span class="nv">SCONE_MMAP32BIT</span><span class="o">=</span><span class="m">0</span>
<span class="nb">export</span> <span class="nv">SCONE_SSPINS</span><span class="o">=</span><span class="m">100</span>
<span class="nb">export</span> <span class="nv">SCONE_SSLEEP</span><span class="o">=</span><span class="m">4000</span>
<span class="nb">export</span> <span class="nv">SCONE_KERNEL</span><span class="o">=</span><span class="m">0</span>
<span class="nb">export</span> <span class="nv">SCONE_HEAP</span><span class="o">=</span><span class="m">1073741824</span>
<span class="nb">export</span> <span class="nv">SCONE_CONFIG</span><span class="o">=</span>/etc/sgx-musl.conf
<span class="nb">export</span> <span class="nv">SCONE_MODE</span><span class="o">=</span>hw
<span class="nb">export</span> <span class="nv">SCONE_SGXBOUNDS</span><span class="o">=</span>no
<span class="nb">export</span> <span class="nv">SCONE_ALLOW_DLOPEN</span><span class="o">=</span>no
Revision: 9b355b99170ad434010353bb9f4dca24e532b1b7
Branch: master
Configure options: --enable-file-prot --enable-shared --enable-debug --prefix<span class="o">=</span>/scone/src/built/cross-compiler/x86_64-linux-musl
</pre></div>

<p>You can now connect to port 8080, for example, with <em>curl</em>:</p>
<div class="codehilite"><pre><span></span>$ curl localhost:8080/SCONE
Hi there, I love SCONE!
</pre></div>

<p>You can terminate the server with</p>
<div class="codehilite"><pre><span></span>$ curl localhost:8080/EXIT
curl: <span class="o">(</span><span class="m">52</span><span class="o">)</span> Empty reply from server
</pre></div>

<h2 id="debugging">Debugging<a class="headerlink" href="#debugging" title="Permanent link">&para;</a></h2>
<p>SCONE supports debugging of programs running inside of an enclave with the help of gdb.</p>
<h3 id="debugging-inside-of-a-container">Debugging inside of a container<a class="headerlink" href="#debugging-inside-of-a-container" title="Permanent link">&para;</a></h3>
<p>Standard containers have not sufficient rights to use the debugger.  Hence, you must start a container with <em>SYS_PTRACE</em> capability. For example:</p>
<div class="codehilite"><pre><span></span>$ docker run --cap-add SYS_PTRACE -it -p <span class="m">8080</span>:8080 -v <span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">&quot;</span>/EXAMPLE:/usr/src/myapp -w /usr/src/myapp  sconecuratedimages/crosscompilers:scone
</pre></div>

<h3 id="handling-illegal-instructions">Handling Illegal instructions<a class="headerlink" href="#handling-illegal-instructions" title="Permanent link">&para;</a></h3>
<p>Some instructions, like CPUID, are not permitted inside of enclaves. For some of these instructions, like CPUID, we provide an automatic emulation. However, we recommend not to use any illegal instructions inside of enclaves despite having an automatic emulation of these instructions. For example, we provide static replacements of the CPUID instruction. </p>
<p>If your program contains some illegal instructions, you need to ask the debugger to forward the signals,
that these illegal instructions cause, to the program via <strong>handle SIGILL nostop pass</strong>: </p>
<div class="codehilite"><pre><span></span>$ scone-gdb ./web-srv-go
GNU gdb <span class="o">(</span>Ubuntu <span class="m">7</span>.12.50.20170314-0ubuntu1.1<span class="o">)</span> <span class="m">7</span>.12.50.20170314-git
Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2017</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="m">3</span> or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type <span class="s2">&quot;show copying&quot;</span>
and <span class="s2">&quot;show warranty&quot;</span> <span class="k">for</span> details.
This GDB was configured as <span class="s2">&quot;x86_64-linux-gnu&quot;</span>.
Type <span class="s2">&quot;show configuration&quot;</span> <span class="k">for</span> configuration details.
For bug reporting instructions, please see:
&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
For help, <span class="nb">type</span> <span class="s2">&quot;help&quot;</span>.
Type <span class="s2">&quot;apropos word&quot;</span> to search <span class="k">for</span> commands related to <span class="s2">&quot;word&quot;</span>...
Source directories searched: /opt/scone/scone-gdb/gdb-sgxmusl-plugin:<span class="nv">$cdir</span>:<span class="nv">$cwd</span>
Setting environment variable <span class="s2">&quot;LD_PRELOAD&quot;</span> to null value.
Reading symbols from ./web-srv-go...done.
<span class="o">[</span>SCONE<span class="o">]</span> Initializing...
<span class="o">(</span>gdb<span class="o">)</span> handle SIGILL nostop pass
Signal        Stop  Print   Pass to program Description
SIGILL        No    Yes Yes     Illegal instruction
<span class="o">(</span>gdb<span class="o">)</span>
</pre></div>

<p>Since we do not patch the CPUID instructions in this run, you will see something like this:</p>
<div class="codehilite"><pre><span></span><span class="o">(</span>gdb<span class="o">)</span> run
Starting program: /usr/src/myapp/web-srv-go 
warning: Error disabling address space randomization: Operation not permitted
<span class="o">[</span>Thread debugging using libthread_db enabled<span class="o">]</span>
Using host libthread_db library <span class="s2">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span>.
<span class="o">[</span>SCONE<span class="o">]</span> Enclave base: <span class="m">1000000000</span>
<span class="o">[</span>SCONE<span class="o">]</span> Loaded debug symbols
<span class="o">[</span>New Thread 0x7f1786d26700 <span class="o">(</span>LWP <span class="m">105</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f1786525700 <span class="o">(</span>LWP <span class="m">106</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f1785d24700 <span class="o">(</span>LWP <span class="m">107</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f1785523700 <span class="o">(</span>LWP <span class="m">108</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f1787502700 <span class="o">(</span>LWP <span class="m">109</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f17874fa700 <span class="o">(</span>LWP <span class="m">110</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f17874f2700 <span class="o">(</span>LWP <span class="m">111</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7f17874ea700 <span class="o">(</span>LWP <span class="m">112</span><span class="o">)]</span>

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">8</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.
</pre></div>

<p>You could interrupt this execution via control c:</p>
<div class="codehilite"><pre><span></span>^C
Thread <span class="m">1</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGINT, Interrupt.
0x00007f17870f69dd in pthread_join <span class="o">(</span><span class="nv">threadid</span><span class="o">=</span><span class="m">139739022911232</span>, <span class="nv">thread_return</span><span class="o">=</span>0x7ffe1c807928<span class="o">)</span> at pthread_join.c:90
<span class="m">90</span>  pthread_join.c: No such file or directory.
<span class="o">(</span>gdb<span class="o">)</span> where
<span class="c1">#0  0x00007f17870f69dd in pthread_join (threadid=139739022911232, thread_return=0x7ffe1c807928) at pthread_join.c:90</span>
<span class="c1">#1  0x0000002000004053 in main (argc=1, argv=0x7ffe1c807c18, envp=0x7ffe1c807c28) at ./tools/starter-exec.c:764</span>
<span class="o">(</span>gdb<span class="o">)</span> cont
Continuing.
</pre></div>

<h3 id="breakpoints">Breakpoints<a class="headerlink" href="#breakpoints" title="Permanent link">&para;</a></h3>
<p>Of course, you might also set breakpoints. Say, we want to get control in the debugger whenever a request is being
processed by the handler. We would set a breakpoint at function <strong>main.handler</strong> as follows:</p>
<div class="codehilite"><pre><span></span>$ scone-gdb ./web-srv-go
...
<span class="o">[</span>SCONE<span class="o">]</span> Initializing...
<span class="o">(</span>gdb<span class="o">)</span> handle SIGILL nostop pass
Signal        Stop      Print   Pass to program Description
SIGILL        No        Yes     Yes             Illegal instruction
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">break</span> main.handler
Function <span class="s2">&quot;main.handler&quot;</span> not defined.
Make breakpoint pending on future shared library load? <span class="o">(</span>y or <span class="o">[</span>n<span class="o">])</span> y
Breakpoint <span class="m">1</span> <span class="o">(</span>main.handler<span class="o">)</span> pending.
<span class="o">(</span>gdb<span class="o">)</span> run
Starting program: /usr/src/myapp/web-srv-go 
warning: Error disabling address space randomization: Operation not permitted
<span class="o">[</span>Thread debugging using libthread_db enabled<span class="o">]</span>
Using host libthread_db library <span class="s2">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span>.
<span class="o">[</span>SCONE<span class="o">]</span> Enclave base: <span class="m">1000000000</span>
<span class="o">[</span>SCONE<span class="o">]</span> Loaded debug symbols
<span class="o">[</span>New Thread 0x7fb6cad32700 <span class="o">(</span>LWP <span class="m">243</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6ca531700 <span class="o">(</span>LWP <span class="m">244</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6c9d30700 <span class="o">(</span>LWP <span class="m">245</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6c952f700 <span class="o">(</span>LWP <span class="m">246</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6cb50e700 <span class="o">(</span>LWP <span class="m">247</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6cb506700 <span class="o">(</span>LWP <span class="m">248</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6cb4fe700 <span class="o">(</span>LWP <span class="m">249</span><span class="o">)]</span>
<span class="o">[</span>New Thread 0x7fb6cb4f6700 <span class="o">(</span>LWP <span class="m">250</span><span class="o">)]</span>

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.

Thread <span class="m">6</span> <span class="s2">&quot;web-srv-go&quot;</span> received signal SIGILL, Illegal instruction.
</pre></div>

<p>Note that at the time when we are setting the breakpoint, the symbols of the code running inside
of the enclave are not yet known. Hence, we just let gdb know that the symbol will be defined later on.</p>
<p>We are now sending a request with the help of <em>curl</em> from a different window. This triggers the breakpoint:</p>
<div class="codehilite"><pre><span></span><span class="o">[</span>Switching to Thread 0x7fb6cb506700 <span class="o">(</span>LWP <span class="m">248</span><span class="o">)]</span>

Thread <span class="m">7</span> <span class="s2">&quot;web-srv-go&quot;</span> hit Breakpoint <span class="m">1</span>, main.handler <span class="o">(</span><span class="nv">w</span><span class="o">=</span>..., <span class="nv">r</span><span class="o">=</span>0x100909e300<span class="o">)</span> at web-srv.go:8
<span class="m">8</span>       func handler<span class="o">(</span>w http.ResponseWriter, r *http.Request<span class="o">)</span> <span class="o">{</span>
<span class="o">(</span>gdb<span class="o">)</span> n
<span class="m">9</span>           fmt.Fprintf<span class="o">(</span>w, <span class="s2">&quot;Hi there, I love %s!&quot;</span>, r.URL.Path<span class="o">[</span><span class="m">1</span>:<span class="o">])</span>
<span class="o">(</span>gdb<span class="o">)</span> n
<span class="m">8</span>       func handler<span class="o">(</span>w http.ResponseWriter, r *http.Request<span class="o">)</span> <span class="o">{</span>
<span class="o">(</span>gdb<span class="o">)</span> c
Continuing.
</pre></div>

<p>&copy; <a href="http://www.scontain.com">scontain.com</a>, November 2017. <a href="mailto:info@scontain.com">Questions or Suggestions?</a></p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Fortran/" title="Fortran" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Fortran
              </span>
            </div>
          </a>
        
        
          <a href="../Java/" title="Java" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Java
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-103149717-2","sconedocs.github.io"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>